# DRAFT - Le Parallaxe (Fil Rouge Narratif)

## Statut
**Draft** - En attente de validation avec Alex (Product Manager)

## Issue Associée
À créer après validation du draft

## Vue d'Ensemble

Le Parallaxe est un phénomène anormal qui poursuit silencieusement chaque explorateur. Il se manifeste rarement, sous des formes subtiles que seul le joueur perçoit. Le Parallaxe n'a pas de nature confirmée : il peut être un signal, une entité, une résonance, un écho temporel ou une projection psychique.

**Objectifs** :
- Introduire un mystère personnel et persistant
- Encourager le retour quotidien sans imposer de grind
- Alimenter le lore de l'univers de manière contrôlée
- Donner l'impression que le joueur occupe une place singulière
- Créer de la discussion entre joueurs sans révéler la vérité
- Laisser toutes les interprétations possibles ouvertes

**Philosophie** : Le but de cette mécanique est de créer un fil rouge narratif à long terme. Le joueur reçoit des fragments d'indices de manière irrégulière, parfois espacés de plusieurs jours de jeu, afin de nourrir une curiosité durable.

## Règles de Base

### Activation

Les indices du Parallaxe sont déclenchés par :
- **Déclencheurs internes** : Score élevé, découvertes rares, progression
- **Déclencheurs externes** : Sessions espacées, événements globaux
- **Déclencheurs narratifs** : Certains choix dans les événements CYOA
- **Déclencheurs temporels** : Périodes d'inactivité prolongée

### Fonctionnement

**Fréquence** :
- Premier indice durant l'onboarding (30% chance)
- Ensuite : un indice toutes les 10 à 20 sessions
- Possibilité d'indice en cas d'événement exceptionnel

**Manifestation** :
- Formes subtiles et rares
- Visible uniquement par le joueur concerné
- Pas d'explication immédiate
- Fragments cryptiques et ambigus

### Conditions

- Les indices sont **personnels** : Chaque joueur a son propre fil rouge
- Les indices sont **rares** : Pour conserver l'impact narratif
- Les indices sont **cryptiques** : Pas de révélation directe
- Les indices sont **persistants** : Conservés dans le journal secret

### Interactions

**Avec le système narratif CYOA** :
- Certains événements peuvent contenir des branches secrètes
- Textes distordus ou incohérents
- Résultats impossibles

**Avec les mini-jeux** :
- Signaux impossibles à analyser
- Anomalies visuelles ou sonores
- Fragments cryptiques révélés

**Avec le Stellarpedia** :
- Entrées secrètes privées
- Fragments de lore impossibles
- Références à des événements non survenus

**Avec les expéditions** :
- Découvertes impossibles
- Coordonnées altérées
- Traces d'analyse datant d'un "futur" impossible

## Manifestations Possibles

### 1. Signaux Altérés

**Contexte** : Mini-jeux (scan, détection, décryptage)

**Manifestations** :
- Distorsions visuelles
- Pics d'intensité impossibles à analyser
- Fragments de phrases ou coordonnées tronquées
- Symboles inconnus

**Fréquence** : < 1% des mini-jeux

**Persistence** : Les anomalies disparaissent avant que le joueur ne puisse les revoir

### 2. Découvertes Impossibles

**Contexte** : Expéditions et découvertes

**Manifestations** :
- Caractéristiques qui ne devraient pas exister
- Duplicatas subtils dans d'autres secteurs
- Traces d'analyse datant d'un "futur" impossible
- Structures géométriques parfaites dans la faune ou la flore

**Fréquence** : < 0.5% des découvertes

**Persistence** : Les découvertes restent mais avec des anomalies notées

### 3. Entrées Secrètes du Codex

**Contexte** : Stellarpedia

**Manifestations** :
- Entrées masquées, visibles uniquement par le joueur
- Format très court et ambigu
- Non référencée dans le codex public
- Statut spécial `parallaxe`

**Exemples** :
- "Ce secteur connaît ton passage."
- "L'autre version de toi a hésité."
- "Tu n'étais pas censé voir cela."

**Fréquence** : < 2% des découvertes majeures

**Persistence** : Conservées dans le journal secret du joueur

### 4. Logs Fantômes

**Contexte** : Journal du joueur

**Manifestations** :
- Lignes horodatées d'un moment où le joueur n'était pas connecté
- Actions que le joueur n'a jamais effectuées
- Mentions de systèmes inconnus
- Entrées incohérentes

**Exemples** :
- "2025-01-15 03:47 - Scan complet du système X-7 effectué" (joueur dormait)
- "Découverte d'un artefact inconnu dans le secteur Y-12" (secteur jamais visité)

**Fréquence** : < 1% des sessions

**Persistence** : Les logs ne réapparaissent jamais deux fois (disparaissent après lecture)

### 5. Messages Cryptés

**Contexte** : Événements narratifs, mini-jeux, expéditions

**Manifestations** :
- Bruit blanc
- Spectrogrammes incohérents
- Symboles non reconnus
- Texte partiellement interprété

**Exemples** :
- "████████████████" (bruit blanc)
- "//ERROR: Temporal reference invalid//"
- "You are not alone. You were never alone."

**Fréquence** : < 0.5% des événements

**Persistence** : Ajoutés au journal secret, non résolubles immédiatement

### 6. Glitches Visuels/Audio

**Contexte** : Interface, événements, mini-jeux

**Manifestations** :
- Distorsions visuelles brèves (< 1 seconde)
- Sons étranges ou distordus
- Texte qui se déforme légèrement
- Couleurs qui changent momentanément

**Fréquence** : < 1% des sessions

**Persistence** : Éphémères, pas de capture possible

## Fréquence des Indices

### Distribution Recommandée

- **Premier indice** : Durant l'onboarding (30% chance)
- **Indices réguliers** : Un indice toutes les 10 à 20 sessions
- **Indices exceptionnels** : En cas d'événement majeur (grand score, secteur critique, échec majeur)

### Calcul de Fréquence

**Base** : 5% de chance par session après l'onboarding

**Modificateurs** :
- Score élevé dans mini-jeu (+2%)
- Découverte rare (+3%)
- Événement exceptionnel (+5%)
- Période d'inactivité (+1% par jour d'absence, max +10%)

**Maximum** : 15% de chance par session (rare)

## Déclencheurs Possibles

### Déclencheurs Internes

1. **Succès élevé ou échec critique** dans un mini-jeu
2. **Découverte d'un système ou d'un artefact rare**
3. **Première rencontre avec une espèce intelligente**
4. **Score exceptionnel** dans un événement narratif
5. **Progression importante** (niveau, milestone)

### Déclencheurs Externes

1. **Période d'inactivité prolongée** (3+ jours)
2. **Exploration d'un secteur "porteur"** du Parallaxe
3. **Publication dans le Stellarpedia** (contribution majeure)
4. **Événement global** (si système implémenté)

### Déclencheurs Narratifs

1. **Choix spécifiques** dans les événements CYOA
2. **Branches secrètes** des événements
3. **Événements liés au Parallaxe** (très rares)

## Système de Progression du Mystère

### Niveaux de Révélation

Le Parallaxe ne se révèle jamais complètement, mais progresse par fragments :

**Niveau 1 - Indices Subtils** (Sessions 1-20) :
- Glitches visuels/audio
- Signaux altérés occasionnels
- Premiers logs fantômes

**Niveau 2 - Fragments Cryptiques** (Sessions 21-50) :
- Entrées secrètes du Codex
- Messages cryptés partiels
- Découvertes impossibles

**Niveau 3 - Patterns Émergents** (Sessions 51+) :
- Patterns dans les indices
- Références croisées
- Questions sans réponses

### Arcs Narratifs Non Linéaires

- Pas de progression linéaire obligatoire
- Chaque joueur peut avoir des indices différents
- Pas de "solution" unique
- Toutes les interprétations restent valides

## Intégration Technique

### Tables de Base de Données

```sql
mystery_clues
- id
- player_id
- clue_code (unique identifier for the clue type)
- clue_type ('signal_altered', 'impossible_discovery', 'codex_secret', 'ghost_log', 'encrypted_message', 'glitch')
- content (JSON - stores the clue content)
- context (JSON - stores where/when it appeared)
- delivered_at (datetime)
- read_at (datetime, nullable)
- created_at
- updated_at

player_parallaxe_progression
- id
- player_id
- level (1-3, represents progression level)
- clues_received_count (int)
- last_clue_at (datetime, nullable)
- patterns_discovered (JSON - stores discovered patterns)
- created_at
- updated_at

parallaxe_triggers
- id
- player_id
- trigger_type ('internal', 'external', 'narrative')
- trigger_code (string - identifier)
- triggered_at (datetime)
- clue_generated (bool)
- created_at
```

### Système de Génération

**Algorithme de sélection** :
1. Vérification des déclencheurs actifs
2. Calcul de la probabilité selon les modificateurs
3. Roll aléatoire (1-100)
4. Si succès : Sélection d'un type d'indice selon la progression
5. Génération du contenu cryptique
6. Livraison au joueur

**Système de contenu** :
- Templates de contenu cryptique
- Génération procédurale avec variations
- Personnalisation selon la progression du joueur
- Pas de répétition exacte

### Points d'Intégration

1. **Mini-jeux** : Vérification après chaque mini-jeu
2. **Événements CYOA** : Vérification lors de certains choix
3. **Expéditions** : Vérification après découvertes rares
4. **Stellarpedia** : Génération d'entrées secrètes
5. **Journal** : Génération de logs fantômes
6. **Interface** : Glitches visuels/audio occasionnels

## Équilibrage

### Rareté

- **Ultra rare** : Pour conserver l'impact narratif
- **Distribution** : 1 indice toutes les 10-20 sessions en moyenne
- **Exceptionnel** : Indices supplémentaires lors d'événements majeurs

### Impact

- **Subtilité** : Les indices ne doivent pas perturber le gameplay normal
- **Curiosité** : Assez pour créer de la curiosité, pas assez pour frustrer
- **Mystère** : Jamais de révélation complète, toujours des questions

### Progression

- **Lente** : Progression très lente sur plusieurs mois
- **Non linéaire** : Pas de chemin fixe
- **Personnelle** : Chaque joueur a son propre fil rouge

## Exemples et Cas d'Usage

### Exemple 1 : Premier Indice (Onboarding)

**Situation** : Joueur nouveau, étape 2 de l'onboarding

**Manifestation** : Glitch visuel léger + message "Anomalie non identifiée"

**Résultat** : Joueur intrigué, premier indice du Parallaxe enregistré

### Exemple 2 : Signal Altéré (Mini-Jeu)

**Situation** : Joueur niveau 10, mini-jeu Scan Circulaire, score 95/100

**Manifestation** : Un signal impossible à verrouiller apparaît brièvement

**Résultat** : Indice ajouté au journal secret : "Signal non conforme aux paramètres connus"

### Exemple 3 : Entrée Secrète (Stellarpedia)

**Situation** : Joueur niveau 15, découverte d'une planète rare

**Manifestation** : Entrée secrète apparaît dans le Stellarpedia : "Cette planète connaît ton passage."

**Résultat** : Joueur perplexe, indice conservé dans le journal secret

### Exemple 4 : Log Fantôme (Journal)

**Situation** : Joueur se connecte après 5 jours d'absence

**Manifestation** : Log dans le journal : "2025-01-20 02:15 - Analyse complète du système Z-9 effectuée" (joueur dormait)

**Résultat** : Joueur confus, log disparaît après lecture, indice ajouté

## Cas Limites

1. **Trop d'indices** : Limite de 1 indice par session maximum
2. **Pas assez d'indices** : Garantie d'au moins 1 indice toutes les 20 sessions
3. **Indices identiques** : Variété garantie (pas de répétition exacte)
4. **Joueur inactif** : Accumulation légère des chances (+1% par jour)

## Métriques à Surveiller

### Métriques d'Engagement
- Fréquence moyenne des indices par joueur
- Temps entre les indices
- Taux de lecture des indices

### Métriques Narratives
- Distribution des types d'indices
- Progression moyenne des joueurs
- Satisfaction du mystère (survey optionnel)

### Métriques Techniques
- Performance de génération des indices
- Taux d'erreurs techniques
- Distribution des déclencheurs

## Implémentation Technique

### Spécifications

**Système de génération** :
- Algorithme de probabilité avec modificateurs
- Sélection de type d'indice selon la progression
- Génération de contenu cryptique
- Livraison au joueur

**Système de stockage** :
- Journal secret par joueur
- Conservation permanente des indices
- Organisation par type et date

**Système d'affichage** :
- Interface dédiée pour le journal secret
- Affichage des indices avec contexte
- Pas de spoilers pour les autres joueurs

### Points d'Attention

1. **Subtilité** : Les indices doivent être subtils, pas intrusifs
2. **Variété** : Assez de contenu pour éviter la répétition
3. **Performance** : Génération rapide (< 100ms)
4. **Mystère** : Jamais de révélation complète

### Tests à Prévoir

1. **Tests unitaires** :
   - Calcul des probabilités
   - Génération de contenu cryptique
   - Sélection de type d'indice

2. **Tests d'intégration** :
   - Déclenchement des indices
   - Intégration avec les autres systèmes
   - Affichage dans le journal secret

3. **Tests d'équilibrage** :
   - Fréquence des indices
   - Distribution des types
   - Satisfaction des joueurs

## Historique

- Création du draft initial basé sur `parallax.md`

## Références

- **[parallax.md](../local-brainstorming-data/parallax.md)** : Document source du brainstorming
- **[GAME-DESIGNER.md](../agents/GAME-DESIGNER.md)** : Documentation de l'agent Game Designer
- **[design-game-mechanic.md](../prompts/design-game-mechanic.md)** : Guide pour concevoir des mécaniques

